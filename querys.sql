-- Sub consulta e Consulta externa

-- Deve-se mostrar o nome de todos os alunos que agendaram laboratÃ³rios na data 02-JAN-22
SELECT U.NOME
FROM USUARIO U INNER JOIN ACESSA A
            ON U.MATRICULA = A.MATRICULA INNER JOIN AGENDAMENTO AG
    	ON A.COD_AGEND = AG.COD_AGEND
WHERE AG.DATA_INICIO = '02-JAN-22' AND U.MATRICULA IN (
    	SELECT A.MATRICULA
            FROM ALUNO A)

-- Mostre os usuarios que levaram mais de um 1 visitante 
SELECT U.NOME, COUNT(*)
FROM USUARIO U INNER JOIN VISITANTE V ON U.MATRICULA = U.MATRICULA
GROUP BY U.NOME
HAVING COUNT(*) > 1

-- Mostre o Num_Sala dos laboratorios que nunca tiveram um agendamento
SELECT L.NUM_SALA 
FROM LABORATORIO L LEFT JOIN ACESSA A ON L.COD_LAB = A.COD_LAB INNER JOIN AGENDAMENTO AG ON A.COD_AGEND = AG.COD_AGEND
WHERE A.COD_LAB IS NULL AND AG.COD_AGEND IS NULL; 
